<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-GB">
<head>
  <script src="headerfooter.js"></script>
  <!--FIXME: Bug in Chrome: defer is ignored-->
  <script>let domLoad = new Promise(() => {}); document.addEventListener("DOMContentLoaded", () => { domLoad = Promise.resolve(); }, { once: true });</script>
  <script async="async" src="messages.js"></script>
  <script async="async" src="../wizard.js"></script>
  <title>TCTemplate</title>
</head>
<body>
  <header>
    <h1>TCTemplate: TrailO Timed Control Map Cards Generator</h1>
    <p id="missingAPIs">Error: Web browser does not support required APIs, or Javascript is disabled. Need to update to newer browser to use TCTemplate.</p>
  </header>
  <nav class="right"><a href="help/index.xhtml" target="help" rel="help">Help</a> <a href="index.xhtml">Home</a></nav>
  <main id="mainView">
    <section>
      <ol>
        <li>Set up an event in <a href="http://purplepen.golde.org" target="prequisites" rel="external">Purple Pen</a>, ensuring the print scale is set correctly. Keep the event title short, so that it fits on one line in the control descriptions (it will not be shown in the finished product anyway).</li>
        <li>Go to Event->Customize Appearance. Untick <em>Use IOF standard sizes</em>. Set the <em>Control circle diameter</em> to 6 mm (current recommended size) and <em>Scale item sizes</em> to <em>Do not scale</em>. Tick <em>Blend purple with underlying map colours</em> and <em>Use overprint effect for colors marked "overprint"</em>. Click OK.</li>
        <li>Mark each question control to be used, cut the circles as required and set the control description. The content of columns A and B does not matter, nor do the control codes.</li>
        <li>Create a course for each problem. Name it in the format <em>name of station.i</em>, where <em>i</em> is the problem number counting from 1. It is not recommended to include the word <em>station</em> in the name, and it is simplest to be just a number, although it could be <em>warm-up</em>. For example, the 3<sup>rd</sup> problem at the 2<sup>nd</sup> could be be named <em>2.3</em>. Set the course type to score. The stations will be printed in the order of the 1<sup>st</sup> map at each station.</li>
        <li>Add the (single) control to the course. It doesn't matter whether a start and finished are also added, so long as they are outside the map excerpts.</li>
        <li>Move the purple number labelling the control out of the field of view. (At the time of writing, Purple Pen does not permit this label to be removed, which would be preferable here.)</li>
        <li>Set the print area for all courses (under the File menu) to have 0 margin, limit the printable area to the page size and untick <em>Set Print Area Automatically</em>. Select a paper size (custom size if necessary) that is large enough to include all parts of the map that are to be printed. Move the print area to cover all desired parts of the map and click done. (Each course/map does not need to have the same print area, although the author considers it easier to do so.)</li>
        <li>Create a single PDF of all the courses using File->Create PDFs->Courses and choosing to have one copy of each course all in a single PDF. Select all courses, including those not intended to be printed, but not the all controls map. Select <em>CMYK</em> as the colour model. Upload the maps PDF: <input type="file" id="coursePDFSelector" accept=".pdf" /></li>
        <li>Create a single PDF of all the control descriptions using File->Create PDFs->Descriptions. Choose fill one page with multiple copies of each course. Select all courses, including those not intended to be printed, but not the all controls. Choose a PDF printer with A4 page size. Leave the box size at the default of 6 mm, and leave the page margins at the default of 12.7 mm on all sides (appears as 13 mm in the main dialog). Upload the descriptions PDF: <input type="file" id="CDPDFSelector" accept=".pdf" /></li>
        <li>Save the Purple Pen file, then upload it to this wizard: <input type="file" id="ppenSelector" accept=".ppen" onchange="tcTemplate.loadppen(this)" /><input type="button" value="Reload" onclick="tcTemplate.loadppen(document.getElementById('ppenSelector'))" /> <span id="ppenStatus"></span></li>
      </ol>
    </section>

    <!--New interface-->
    <section id="fields">
      <!--Initial view has only essential fields visible-->
      <details open="open">
        <summary>File</summary>
        <ul class="fieldList">
          <li>
            <button id="newFile" type="button">New</button>
          </li>
          <li>
            <label for="paramFileSelector">Open</label>
            <span class="inputBlock"><input id="paramFileSelector" type="file" accept=".tex" /></span>
          </li>
          <li>
            <label for="recoverSelect">Recover</label>
            <span class="inputBlock"><select id="recoverSelect"></select></span>
          </li>
          <li>
            <button id="saveParameters" type="button">Save</button>
          </li>
        </ul>
        <p id="paramReadStatus"></p>

        <details open="open">
          <summary>Autosave</summary>
          <ul>
            <li class="tickRow">
              <input id="enableAutoSave" type="checkbox" />
              <label for="enableAutoSave">Enable — stores in a cookie</label>
            </li>
          </ul>
          <details>
            <summary>Options</summary>
            <ul class="fieldList">
              <li>
                <label for="autoSaveFrequency">Frequency</label>
                <span class="inputBlock">
                  <input id="autoSaveFrequency" type="number" min="1" step="any" /><span>s</span>
                </span>
                <span id="autoSaveFrequencyError"></span>
              </li>
              <li>
                <label for="autoSaveSize">History size</label>
                <span class="inputBlock"><input id="autoSaveSize" type="number" min="1" /></span>
                <span id="autoSaveSizeError"></span>
              </li>
            </ul>
            <ul>
              <li class="tickRow">
                <input id="saveOnGenerate" type="checkbox" checked="checked" />
                <label for="saveOnGenerate">Save parameters when generating map cards</label>
              </li>
            </ul>
          </details>
        </details>
      </details>

      <details open="open">
        <summary>Courses</summary>
        <details>
          <summary>Name and order</summary>
          <ul>
            <li class="tickRow">
              <input id="viewDefault" type="checkbox" />
              <label for="viewDefault">View defaults</label>
            </li>
          </ul>
          <ul class="hideIfDefault">
            <li>
              <label for="courseSelect">Course <select id="courseSelect" size="6"></select></label>
              <span class="btnGroup">
                <button id="addCourse" type="button">+ Add</button>
                <button id="deleteCourse" type="button">− Delete</button>
                <button id="moveUpCourse" type="button">↑ Move up</button>
                <button id="moveDownCourse" type="button">↓ Move down</button>
              </span>
            </li>
          </ul>
          <ul class="fieldList hideIfDefault">
            <li>
              <label for="courseName">Course name</label>
              <span class="inputBlock"><input id="courseName" type="text" /></span>
              <span id="courseNameError"></span>
            </li>
          </ul>
        </details>

        <details>
          <summary>Tasks file and template</summary>
          <ul>
            <li>
              <label for="newTasksFile"><input id="newTasksFile" type="radio" name="tasksFile" /> New file with</label>
              <label for="tasksTemplate">template
                <select id="tasksTemplate">
                  <option value="printA5onA4">TempO: Print 2 × A5 cards on A4</option>
                  <option value="onlineTempO">Online TempO</option>
                </select>
              </label>
            </li>
            <li>
              <label for="appendTasksFile"><input id="appendTasksFile" type="radio" name="tasksFile" /> Include with</label>
              <label for="appendTasksCourse">course <select id="appendTasksCourse"></select></label>
            </li>
            <li>
              <label for="hideTasksFile"><input id="hideTasksFile" type="radio" name="tasksFile" /> Hide</label>
            </li>
            <li>
              <button id="setAllTasksFile" class="setAllCourses" type="button">Set all courses</button>
              <button id="resetTasksFile" class="hideIfDefault" type="button">Reset</button>
            </li>
          </ul>
        </details>

        <details open="open">
          <summary>Main properties</summary>
          <ul class="fieldList">
            <li>
              <label for="numTasks">Number of tasks</label>
              <span class="inputBlock">
                <input id="numTasks" type="number" min="1" step="1" />
                <button id="setAllNumTasks" class="setAllCourses" type="button">Set all courses</button>
                <button id="resetNumTasks" class="hideIfDefault" type="button">Reset</button>
              </span>
              <span id="numTasksError"></span>
            </li>
            <li>
              <label for="zeroes">Zeroes</label>
              <span class="inputBlock">
                <input id="zeroes" type="checkbox" />
                <button id="setAllZeroes" class="setAllCourses" type="button">Set all courses</button>
                <button id="resetZeroes" class="hideIfDefault" type="button">Reset</button>
              </span>
            </li>
            <li>
              <label for="mapScale">Map scale</label>
              <span class="inputBlock">
                <span class="withUnit">1:<input id="mapScale" type="number" min="0" step="any" /></span>
                <input id="mapScaleRule" type="checkbox" /><label for="mapScaleRule">Ignore rules</label>
                <button id="setAllMapScale" class="setAllCourses" type="button">Set all courses</button>
                <button id="resetMapScale" class="hideIfDefault" type="button">Reset</button>
              </span>
              <span id="mapScaleError"></span>
            </li>
            <li>
              <label for="contourInterval">Contour interval</label>
              <span class="inputBlock">
                <span class="withUnit"><input id="contourInterval" type="number" min="0" step="any" /><span>m</span></span>
                <input id="contourIntervalRule" type="checkbox" /><label for="contourIntervalRule">Ignore rules</label>
                <button id="setAllContourInterval" class="setAllCourses" type="button">Set all courses</button>
                <button id="resetContourInterval" class="hideIfDefault" type="button">Reset</button>
              </span>
              <span id="contourIntervalError"></span>
            </li>
          </ul>
        </details>

        <details>
          <summary>Additional properties</summary>
          <ul class="fieldList">
            <li class="tcMap">
              <label for="mapShape">Map shape</label>
              <span class="inputBlock">
                <select id="mapShape">
                  <option value="circle">Circle</option>
                  <option value="square">Square</option>
                </select>
                <input id="mapShapeRule" type="checkbox" /><label for="mapShapeRule">Ignore rules</label>
                <button id="setAllMapShape" class="setAllCourses" type="button">Set all courses</button>
                <button id="resetMapShape" class="hideIfDefault" type="button">Reset</button>
              </span>
              <span id="mapShapeError"></span>
            </li>
            <li class="tcMap">
              <label for="mapSize">Map <span id="mapSizeType"></span></label>
              <span class="inputBlock">
                <input id="mapSizeAuto" type="checkbox" /><label for="mapSizeAuto">Auto</label>
                <span class="withUnit"><input id="mapSize" type="number" min="0" max="12" step="any" /><span>cm</span></span>
                <input id="mapSizeRule" type="checkbox" /><label for="mapSizeRule">Ignore rules</label>
                <button id="setAllMapSize" class="setAllCourses" type="button">Set all courses</button>
                <button id="resetMapSize" class="hideIfDefault" type="button">Reset</button>
              </span>
              <span id="mapSizeError"></span>
            </li>
            <li class="tcMap">
              <label for="numKites">Number of kites</label>
              <span class="inputBlock">
                <select id="numKites">
                  <option>1</option>
                  <option>2</option>
                  <option>3</option>
                  <option>4</option>
                  <option>5</option>
                  <option>6</option>
                </select>
                <input id="numKitesRule" type="checkbox" /><label for="numKitesRule">Ignore rules</label>
                <button id="setAllNumKites" class="setAllCourses" type="button">Set all courses</button>
                <button id="resetNumKites" class="hideIfDefault" type="button">Reset</button>
              </span>
              <span id="numKitesError"></span>
            </li>
          </ul>
        </details>

        <details>
          <summary>Customise layout</summary>
          <ul>
            <!-- <li class="tickRow"><input id="orientateSolutions" type="checkbox" /><label for="orientateSolutions">Orientate solutions to viewing points</label></li> -->
          </ul>
          <p>TODO: MOVE THIS TO HELP? There are no sanity checks here, so check the output carefully.</p>
          <ul>
            <li>
              <button id="setAllCustomLayout" type="button" class="setAllCourses">Set all courses to defaults</button>
              <button id="resetAllCustomLayout" type="button">Reset all</button>
            </li>
          </ul>
          <ul>
            <li class="tickRow">
              <input id="debugCircle" type="checkbox" /><label for="debugCircle">Show construction marks to verify position of control circle and do not orientate maps</label>
              <button id="setAllDebugCircle" class="setAllCourses" type="button">Set all courses</button>
              <button id="resetDebugCircle" type="button">Reset</button>
            </li>
          </ul>
          <div class="printTCOptions">
            <fieldset>
              <legend>Station name</legend>
              <ul class="fieldList">
                <li>
                  <label for="IDFontSize">Font size</label>
                  <span class="inputBlock">
                    <span class="withUnit"><input id="IDFontSize" type="number" min="0" step="any" /><span>cm</span></span>
                    <button id="setAllIDFontSize" class="setAllCourses" type="button">Set all courses</button>
                    <button id="resetIDFontSize" type="button">Reset</button>
                  </span>
                  <span id="IDFontSizeError"></span>
                </li>
              </ul>
            </fieldset>
            <fieldset>
              <legend>Page order boxes</legend>
              <ul class="fieldList">
                <li>
                  <label for="checkWidth">Width</label>
                  <span class="inputBlock">
                    <span class="withUnit"><input id="checkWidth" type="number" min="0" step="any" /><span>cm</span></span>
                    <button id="setAllCheckWidth" class="setAllCourses" type="button">Set all courses</button>
                    <button id="resetCheckWidth" type="button">Reset</button>
                  </span>
                  <span id="checkWidthError"></span>
                </li>
                <li>
                  <label for="checkHeight">Height</label>
                  <span class="inputBlock">
                    <span class="withUnit"><input id="checkHeight" type="number" min="0" step="any" /><span>cm</span></span>
                    <button id="setAllCheckHeight" class="setAllCourses" type="button">Set all courses</button>
                    <button id="resetCheckHeight" type="button">Reset</button>
                  </span>
                  <span id="checkHeightError"></span>
                </li>
                <li>
                  <label for="checkFontSize">Number font size</label>
                  <span class="inputBlock">
                    <span class="withUnit"><input id="checkFontSize" type="number" min="0" step="any" /><span>cm</span></span>
                    <button id="setAllCheckFontSize" class="setAllCourses" type="button">Set all courses</button>
                    <button id="resetCheckFontSize" type="button">Reset</button>
                  </span>
                  <span id="checkFontSizeError"></span>
                </li>
                <li>
                  <label for="removeFontSize"><em>Remove</em> font size</label>
                  <span class="inputBlock">
                    <span class="withUnit"><input id="removeFontSize" type="number" min="0" step="any" /><span>cm</span></span>
                    <button id="setAllRemoveFontSize" class="setAllCourses" type="button">Set all courses</button>
                    <button id="resetRemoveFontSize" type="button">Reset</button>
                  </span>
                  <span id="removeFontSizeError"></span>
                </li>
              </ul>
            </fieldset>
            <fieldset>
              <legend>Pointing boxes</legend>
              <ul class="fieldList">
                <li>
                  <label for="pointHeight">Height</label>
                  <span class="inputBlock">
                    <span class="withUnit"><input id="pointHeight" type="number" min="0" step="any" /><span>cm</span></span>
                    <button id="setAllPointHeight" class="setAllCourses" type="button">Set all courses</button>
                    <button id="resetPointHeight" type="button">Reset</button>
                  </span>
                  <span id="pointHeightError"></span>
                </li>
                <li>
                  <label for="letterFontSize">Letter font size</label>
                  <span class="inputBlock">
                    <span class="withUnit"><input id="letterFontSize" type="number" min="0" step="any" /><span>cm</span></span>
                    <button id="setAllLetterFontSize" class="setAllCourses" type="button">Set all courses</button>
                    <button id="resetLetterFontSize" type="button">Reset</button>
                  </span>
                  <span id="letterFontSizeError"></span>
                </li>
                <li>
                  <label for="phoneticFontSize">Phonetic font size</label>
                  <span class="inputBlock">
                    <span class="withUnit"><input id="phoneticFontSize" type="number" min="0" step="any" /><span>cm</span></span>
                    <button id="setAllPhoneticFontSize" class="setAllCourses" type="button">Set all courses</button>
                    <button id="resetPhoneticFontSize" type="button">Reset</button>
                  </span>
                  <span id="phoneticFontSizeError"></span>
                </li>
              </ul>
            </fieldset>
          </div>
        </details>
      </details>

      <details open="open">
        <summary>Stations</summary>
        <ul class="hideIfDefault">
          <li>
            <label for="stationSelect">Station <select id="stationSelect" size="6"></select></label>
            <span class="btnGroup">
              <button id="addStation" type="button">+ Add</button>
              <button id="deleteStation" type="button">− Delete</button>
              <button id="moveUpStation" type="button">↑ Move up</button>
              <button id="moveDownStation" type="button">↓ Move down</button>
            </span>
          </li>
        </ul>
        <ul class="fieldList hideIfDefault">
          <li>
            <label for="stationName">Station name</label>
            <span class="inputBlock"><input id="stationName" type="text" /></span>
            <span id="stationNameError"></span>
          </li>
        </ul>
        <details>
          <summary>Additional properties</summary>
          <ul class="fieldList">
            <li>
              <label for="stationCourse">Course</label>
              <span class="inputBlock">
                <select id="stationCourse"></select>
                <button id="setAllStationCourse" class="setAllCourses" type="button">Set all stations</button>
                <button id="resetStationCourse" class="hideIfDefault" type="button">Reset</button>
              </span>
            </li>
            <li>
              <label for="showStationTasks">Print tasks</label>
              <span class="inputBlock">
                <input id="showStationTasks" type="checkbox" />
                <button id="setAllShowStationTasks" class="setAllCourses" type="button">Set all stations</button>
                <button id="resetShowStationTasks" class="hideIfDefault" type="button">Reset</button>
              </span>
            </li>
            <!--Solutions maps: new map/add to existing/hide; colour on solutions map (or make it a course option)-->
          </ul>
        </details>

        <details>
          <summary>Kites<span class="zeroes"> and zeroes</span></summary>
          <ul>
            <li class="tickRow">
              <input id="kitesAutoPopulate" type="checkbox" />
              <label for="kitesAutoPopulate">Auto add/merge list</label>
              <button id="setAllKitesAutoPopulate" class="setAllCourses" type="button">Set all stations</button>
              <button id="resetKitesAutoPopulate" class="hideIfDefault" type="button">Reset</button>
            </li>
            <li>
              <label class="hideIfDefault">Kite<span class="zeroes">/zero</span> <select id="kiteSelect" size="6"></select></label>
              <span class="btnGroup hideIfDefault">
                <button id="addKite" type="button" class="zeroes">+ Add</button>
                <button id="deleteKite" type="button" class="zeroes">− Delete</button>
                <button id="moveUpKite" type="button" class="manualOrder">↑ Move up</button>
                <button id="moveDownKite" type="button" class="manualOrder">↓ Move down</button>
              </span>
            </li>
            <li class="autoOrder">
              <input id="autoOrderKites" type="checkbox" class="hideIfDefault" />
              <label for="autoOrderKites" class="hideIfDefault">Auto order</label>
              <button id="setAllAutoOrderKites" class="setAllCourses" type="button">Set all stations</button>
              <button id="resetAutoOrderKites" class="hideIfDefault" type="button">Reset</button>
          </li>
          </ul>
          <ul class="fieldList hideIfDefault">
            <li>
              <label for="kiteName">Kite<span class="zeroes">/zero</span> name</label>
              <span class="inputBlock"><input id="kiteName" type="text" /></span>
              <span id="kiteNameError"></span>
            </li>
            <li class="zeroes">
              <label for="zero">Zero</label>
              <span class="inputBlock"><input id="zero" type="checkbox" /></span>
            </li>
          </ul>

          <fieldset>
            <legend>Position</legend>
            <fieldset>
              <legend>Set all</legend>
              <ul class="autoBtnList">
                <li>
                  <span>All stations</span>
                  <button id="autoAllKitePosAll" type="button">Automatically</button>
                  <button id="manualAllKitePosAll" type="button">Manually</button>
                </li>
                <li class="hideIfDefault">
                  <span>This station</span>
                  <button id="autoAllKitePosStation" type="button">Automatically</button>
                  <button id="manualAllKitePosStation" type="button">Manually</button>
                </li>
              </ul>
            </fieldset>
            <ul class="fieldList hideIfDefault">
              <li>
                <label for="kitex">x</label>
                <span class="inputBlock">
                  <input id="kitexAuto" type="checkbox" /><label for="kitexAuto">Auto</label>
                  <span class="withUnit"><input id="kitex" type="number" min="0" step="any" /><span>cm</span></span>
                </span>
                <span id="kitexError"></span>
              </li>
              <li>
                <label for="kitey">y</label>
                <span class="inputBlock">
                  <input id="kiteyAuto" type="checkbox" /><label for="kiteyAuto">Auto</label>
                  <span class="withUnit"><input id="kitey" type="number" min="0" step="any" /><span>cm</span></span>
                </span><span id="kiteyError"></span>
              </li>
            </ul>
          </fieldset>
        </details>

        <details>
          <summary>Heading and viewing point</summary>
          <fieldset>
            <legend>Set all</legend>
            <ul class="autoBtnList">
              <li>
                <span>All stations</span>
                <button id="autoAllHeadingVPAll" type="button">Automatically</button>
                <button id="manualAllHeadingVPAll" type="button">Manually</button>
              </li>
              <li class="hideIfDefault">
                <span>This station</span>
                <button id="autoAllHeadingVPStation" type="button">Automatically</button>
                <button id="manualAllHeadingVPStation" type="button">Manually</button>
              </li>
            </ul>
          </fieldset>
          <fieldset class="hideIfDefault">
            <legend>Viewing point</legend>
            <ul class="fieldList">
              <li>
                <label for="VPx">x</label>
                <span class="inputBlock">
                  <input id="VPxAuto" type="checkbox" /><label for="VPxAuto">Auto</label>
                  <span class="withUnit"><input id="VPx" type="number" min="0" step="any" /><span>cm</span></span>
                </span>
                <span id="VPxError"></span>
              </li>
              <li>
                <label for="VPy">y</label>
                <span class="inputBlock">
                  <input id="VPyAuto" type="checkbox" /><label for="VPyAuto">Auto</label>
                  <span class="withUnit"><input id="VPy" type="number" min="0" step="any" /><span>cm</span></span>
                </span>
                <span id="VPyError"></span>
              </li>
            </ul>
          </fieldset>
          <ul class="fieldList">
            <li class="hideIfDefault">
              <label for="heading">Heading</label>
              <span class="inputBlock">
                <input id="headingAuto" type="checkbox" /><label for="headingAuto">Auto</label>
                <span class="withUnit"><input id="heading" type="number" step="any" />°</span>
              </span>
              <span id="headingError"></span>
            </li>
            <li>
              <label for="blankMapPage">Blank map page</label>
              <span class="inputBlock">
                <input id="blankMapPageAuto" type="checkbox" /><label for="blankMapPageAuto">Auto</label>
                <input id="blankMapPage" type="number" min="1" />
                <button id="setAllBlankMapPage" class="setAllCourses" type="button">Set all stations</button>
                <button id="resetBlankMapPage" class="hideIfDefault" type="button">Reset</button>
              </span><span id="blankMapPageError"></span>
            </li>
          </ul>
        </details>

        <details open="open">
          <summary>Tasks</summary>
          <ul>
            <li>
              <label class="hideIfDefault">Task <select id="taskSelect" size="6"></select></label>
              <span class="btnGroup hideIfDefault">
                <button id="addTask" type="button">+ Add</button>
                <button id="deleteTask" type="button">− Delete</button>
                <button id="moveUpTask" type="button" class="manualOrder">↑ Move up</button>
                <button id="moveDownTask" type="button" class="manualOrder">↓ Move down</button>
              </span>
            </li>
          </ul>
          <ul class="fieldList hideIfDefault">
            <li>
              <label for="taskName">Task name</label>
              <span class="inputBlock"><input id="taskName" type="text" /></span>
              <span id="taskNameError"></span>
            </li>
          </ul>
          <fieldset>
            <legend>Solution</legend>
            <fieldset>
              <legend>Set all</legend>
              <ul class="autoBtnList">
                <li>
                  <span>All stations</span>
                  <button id="autoAllSolutionAll" type="button">Automatically</button>
                  <button id="manualAllSolutionAll" type="button">Manually</button>
                </li>
                <li class="hideIfDefault">
                  <span>This station</span>
                  <button id="autoAllSolutionStation" type="button">Automatically</button>
                  <button id="manualAllSolutionStation" type="button">Manually</button>
                </li>
              </ul>
            </fieldset>
            <ul class="fieldList hideIfDefault">
              <li>
                <label for="solution">Answer</label>
                <span class="inputBlock">
                  <input id="solutionAuto" type="checkbox" /><label for="solutionAuto">Auto</label>
                  <select id="solution"></select>
                </span>
                <span id="solutionStatus"></span>
              </li>
            </ul>
          </fieldset>

          <details>
            <summary>Positions on input PDFs</summary>
            <p>TODO: MOVE TO HELP FILE Positions are measured from the bottom-left corner of the page.</p>
            <fieldset>
              <legend>Set all</legend>
              <ul class="autoBtnList">
                <li>
                  <span>All stations</span>
                  <button id="autoAllTaskPositionsAll" type="button">Automatically</button>
                  <button id="manualAllTaskPositionsAll" type="button">Manually</button>
                </li>
                <li class="hideIfDefault">
                  <span>This station</span>
                  <button id="autoAllTaskPositionsStation" type="button">Automatically</button>
                  <button id="manualAllTaskPositionsStation" type="button">Manually</button>
                </li>
              </ul>
            </fieldset>
            <fieldset class="hideIfDefault">
              <legend>Control circle</legend>
              <ul class="fieldList">
                <li>
                  <label for="circlePage">Page</label>
                  <span class="inputBlock">
                    <input id="circlePageAuto" type="checkbox" /><label for="circlePageAuto">Auto</label>
                    <input id="circlePage" type="number" min="1" />
                  </span>
                  <span id="circlePageError"></span>
                </li>
                <li>
                  <label for="circlex">x</label>
                  <span class="inputBlock">
                    <input id="circlexAuto" type="checkbox" /><label for="circlexAuto">Auto</label>
                    <span class="withUnit"><input id="circlex" type="number" min="0" step="any" /><span>cm</span></span>
                  </span>
                  <span id="circlexError"></span>
                </li>
                <li>
                  <label for="circley">y</label>
                  <span class="inputBlock">
                    <input id="circleyAuto" type="checkbox" /><label for="circleyAuto">Auto</label>
                    <span class="withUnit"><input id="circley" type="number" min="0" step="any" /><span>cm</span></span>
                  </span>
                  <span id="circleyError"></span>
                </li>
              </ul>
            </fieldset>
            <fieldset>
              <legend>Control description</legend>
              <ul class="fieldList">
                <li>
                  <label for="CDPage">Page</label>
                  <span class="inputBlock">
                    <input id="CDPageAuto" type="checkbox" /><label for="CDPageAuto">Auto</label>
                    <input id="CDPage" type="number" min="1" />
                    <button id="setAllCDPage" class="setAllCourses" type="button">Set all tasks</button>
                    <button id="resetCDPage" class="hideIfDefault" type="button">Reset</button>
                  </span>
                  <span id="CDPageError"></span>
                </li>
                <li>
                  <label for="CDx">x</label>
                  <span class="inputBlock">
                    <input id="CDxAuto" type="checkbox" /><label for="CDxAuto">Auto</label>
                    <span class="withUnit"><input id="CDx" type="number" min="0" step="any" /><span>cm</span></span>
                    <button id="setAllCDx" class="setAllCourses" type="button">Set all tasks</button>
                    <button id="resetCDx" class="hideIfDefault" type="button">Reset</button>
                  </span>
                  <span id="CDxError"></span>
                </li>
                <li>
                  <label for="CDy">y</label>
                  <span class="inputBlock">
                    <input id="CDyAuto" type="checkbox" /><label for="CDyAuto">Auto</label>
                    <span class="withUnit"><input id="CDy" type="number" min="0" step="any" /><span>cm</span></span>
                    <button id="setAllCDy" class="setAllCourses" type="button">Set all tasks</button>
                    <button id="resetCDy" class="hideIfDefault" type="button">Reset</button>
                  </span>
                  <span id="CDyError"></span>
                </li>
                <li>
                  <label for="CDWidth">Width</label>
                  <span class="inputBlock">
                    <input id="CDWidthAuto" type="checkbox" /><label for="CDWidthAuto">Auto</label>
                    <span class="withUnit"><input id="CDWidth" type="number" min="0" step="any" /><span>cm</span></span>
                    <button id="setAllCDWidth" class="setAllCourses" type="button">Set all tasks</button>
                    <button id="resetCDWidth" class="hideIfDefault" type="button">Reset</button>
                  </span>
                  <span id="CDWidthError"></span>
                </li>
                <li>
                  <label for="CDHeight">Height</label>
                  <span class="inputBlock">
                    <input id="CDHeightAuto" type="checkbox" /><label for="CDHeightAuto">Auto</label>
                    <span class="withUnit"><input id="CDHeight" type="number" min="0" step="any" /><span>cm</span></span>
                    <button id="setAllCDHeight" class="setAllCourses" type="button">Set all tasks</button>
                    <button id="resetCDHeight" class="hideIfDefault" type="button">Reset</button>
                  </span>
                  <span id="CDHeightError"></span>
                </li>
                <li>
                  <label for="CDScale">Scale</label>
                  <span class="inputBlock">
                    <input id="CDScaleAuto" type="checkbox" /><label for="CDScaleAuto">Auto</label>
                    <input id="CDScale" type="number" min="0" step="any" />
                    <button id="setAllCDScale" class="setAllCourses" type="button">Set all tasks</button>
                    <button id="resetCDScale" class="hideIfDefault" type="button">Reset</button>
                  </span>
                  <span id="CDScaleError"></span>
                </li>
              </ul>
            </fieldset>
          </details>
        </details>
      </details>

      <details open="open">
        <summary>Calculate positions and make maps in Purple Pen</summary>
        <ul>
          <li><label for="ppenSelector">Open Purple Pen file <input id="ppenSelector" type="file" accept=".ppen" /></label></li>
          <li><button id="ppenSave" type="button">Save modified Purple Pen file</button></li>
        </ul>
        <div id="ppenStatus"></div>
        <details>
          <summary>Save options</summary>
          <ul>
            <li class="tickRow"><input id="ppenReorder" type="checkbox" /><label for="ppenReorder">Reorder courses in Purple Pen file to match station and task order</label></li>
            <li class="tickRow"><input id="ppenClean" type="checkbox" /><label for="ppenClean">Remove unused courses and controls from Purple Pen file</label></li>
          </ul>
        </details>
      </details>

      <details open="open">
        <summary>Compile map cards</summary>
        <fieldset>
          <legend>Input PDFs</legend>
          <ul class="fieldList">
            <li>
              <label for="coursePDFSelector">Maps</label>
              <span class="inputBlock"><input id="coursePDFSelector" type="file" accept=".pdf" /></span>
            </li>
            <li>
              <label for="CDPDFSelector">Control descriptions</label>
              <span class="inputBlock"><input id="CDPDFSelector" type="file" accept=".pdf" /></span>
            </li>
          </ul>
        </fieldset>
        <ul>
          <li>
            <button id="compileLaTeXBtn" type="button">Generate maps</button>
            <span class="tickRow"><input id="zipFiles" type="checkbox" /><label for="zipFiles">Collate files into a single ZIP</label></span>
          </li>
          <li>
            <span id="compileStatus"></span>
            <a id="saveZIP" href="">Save again</a>
          </li>
        </ul>
        <!-- <a id="viewLog" href="" target="log">View debug log</a> -->
        <ul id="compilers"></ul>
      </details>
    </section>

    <section id="stationProperties">
      <ol start="11">
        <li>Fill in the details of each station in the table:</li>
      </ol>

      <details>
        <summary>Instructions and guidelines</summary>
        <ul>
          <li>Use the first row to overwrite the values for all stations. The values will update automatically.</li>
          <li>Untick the box in the show column to exclude the station from the printed output.</li>
          <li>The station name is read-only; to change it, rename the courses in Purple Pen, then reload the file.</li>
          <li>The number of kites must be less than or equal to 6, and should be 5 or 6 (rule 16.10, <a href="http://orienteering.org/trail-orienteering/rules/" target="rules" rel="external">IOF Trail Orienteering Competition Rules 2018</a>).</li>
          <li>Tick the zeroes box if zero (no kite correct) is a permitted answer. This should be ticked for TempO and unticked for PreO.</li>
          <li>Heading is the bearing in degrees of the line subtending the left-most and right-most kite from the observation point.</li>
          <li>The printed map can either be circular or square (IOF rule 15.7).</li>
          <li>The circle diameter or square side length should be between 5 and 12 cm (IOF rule 15.7). Do not include the unit in the textbox.</li>
          <li>The map scale is read automatically from the Purple Pen file. It may be changed here if the OCAD map file was set up incorrectly, although it will not change the print scale of the map excerpts. It should be 1:4000 or 1:5000 and be constant across all maps in a competition (IOF rule 15.2).</li>
          <li>The contour interval must be stated in metres, without typing the unit in the text box.</li>
        </ul>
      </details>

      <ul>
        <li>Open station data: <input type="file" id="texSelector" accept=".tex" onchange="tcTemplate.loadTeX(this)" /><input type="button" value="Reload" onclick="tcTemplate.loadTeX(document.getElementById('texSelector'))" /> <span id="texReadStatus"></span></li>
        <li><input type="button" value="Save station data" onclick="tcTemplate.saveParameters()" /> <input id="autoSave" type="checkbox" checked="checked" />Automatically save a copy when generating map cards</li>
      </ul>

      <table>
        <thead>
          <tr>
            <th>Station name<!--Also includes several hidden fields:--></th>
            <th>Show</th>
            <th>Kites</th>
            <th>Zeroes</th>
            <th>Heading</th>
            <th>Map shape</th>
            <th>Diameter/side length</th>
            <th>Scale</th>
            <th>Contour interval</th>
          </tr>
        </thead>
        <tbody id="courseTableBody">
          <tr>
            <td class="setAll"><input type="button" value="Set all stations" onclick="tcTemplate.setAllCourses()" /></td>
            <td class="setAll"><input class="showStation" type="checkbox" /></td>
            <td class="setAll"><input class="kites" type="number" min="1" max="6" step="1" required="required" /></td>
            <td class="setAll"><input class="zeroes" type="checkbox" /></td>
            <td class="setAll"><!--<input class="heading" type="number" step="any" onchange="setAllCourses(this)" /> &deg--></td>
            <td class="setAll">
              <select class="mapShape">
                <option></option>
                <option>Circle</option>
                <option>Square</option>
              </select>
            </td>
            <td class="setAll"><input class="mapSize layoutLength" type="number" min="0" max="12" step="any" required="required" /> cm</td>
            <td class="setAll">1:<input class="mapScale" type="number" min="0" step="any" required="required" /></td>
            <td class="setAll"><input class="contourInterval" type="number" min="0" step="any" required="required" /> m</td>
          </tr>
        </tbody>
      </table>

      <br />
      <details>
        <summary>Customise layout</summary>
        <p><input id="debugCircle" type="checkbox" /><label for="debugCircle">Show construction marks to verify position of control circle</label></p>
        <p>All measurements are in cm. There are no sanity checks here, so check the output carefully.</p>
        <table>
          <thead>
            <tr>
              <th colspan="2">Station name</th>
              <th colspan="4">Page order boxes</th>
              <th colspan="3">Pointing boxes</th>
            </tr>
            <tr>
              <th></th>
              <th>Font size</th>
              <th>Width</th>
              <th>Height</th>
              <th>Number font size</th>
              <th><em>Remove</em> font size</th>
              <th>Height</th>
              <th>Letter font size</th>
              <th>Phonetic font size</th>
            </tr>
          </thead>
          <tbody id="layoutTableBody">
            <tr>
              <td><input type="button" value="Insert all defaults" onclick="tcTemplate.resetAllLayout()" /></td>
              <td><input class="IDFontSize" type="button" value="Default" onclick="tcTemplate.resetField(this)" /></td>
              <td><input class="checkWidth" type="button" value="Default" onclick="tcTemplate.resetField(this)" /></td>
              <td><input class="checkHeight" type="button" value="Default" onclick="tcTemplate.resetField(this)" /></td>
              <td><input class="checkFontSize" type="button" value="Default" onclick="tcTemplate.resetField(this)" /></td>
              <td><input class="removeFontSize" type="button" value="Default" onclick="tcTemplate.resetField(this)" /></td>
              <td><input class="pointHeight" type="button" value="Default" onclick="tcTemplate.resetField(this)" /></td>
              <td><input class="letterFontSize" type="button" value="Default" onclick="tcTemplate.resetField(this)" /></td>
              <td><input class="phoneticFontSize" type="button" value="Default" onclick="tcTemplate.resetField(this)" /></td>
            </tr>
            <tr id="layoutSetAllRow">
              <td class="setAll"><input type="button" value="Set all stations" onclick="tcTemplate.setAllLayout()" /></td>
              <td class="setAll"><input class="IDFontSize layoutLength" type="number" min="0" max="29.7" step="any" required="required" /></td>
              <td class="setAll"><input class="checkWidth layoutLength" type="number" min="0" max="29.7" step="any" required="required" /></td>
              <td class="setAll"><input class="checkHeight layoutLength" type="number" min="0" max="29.7" step="any" required="required" /></td>
              <td class="setAll"><input class="checkFontSize layoutLength" type="number" min="0" max="29.7" step="any" required="required" /></td>
              <td class="setAll"><input class="removeFontSize layoutLength" type="number" min="0" max="29.7" step="any" required="required" /></td>
              <td class="setAll"><input class="pointHeight layoutLength" type="number" min="0" max="29.7" step="any" required="required" /></td>
              <td class="setAll"><input class="letterFontSize layoutLength" type="number" min="0" max="29.7" step="any" required="required" /></td>
              <td class="setAll"><input class="phoneticFontSize layoutLength" type="number" min="0" max="29.7" step="any" required="required" /></td>
            </tr>
          </tbody>
        </table>
      </details>

      <ol start="12">
        <li>Select template
          <select id="selectTemplate">
            <option value="printA5onA4" selected="selected">Print 2 × A5 cards on A4 paper</option>
            <option value="onlineTempO">Online TempO</option>
          </select>
        </li>
        <li>
          <button id="compileLaTeXBtn" type="button">Generate map cards</button>
          <span id="compileStatus"></span>
          <a id="savePDF">Save map cards again</a>
          <a id="viewLog">Save debug log</a>
        </li>
      </ol>
      <ol id="printInstructions" start="14">
        <li>Print the produced PDF file on A4 paper in colour and single-sided. Make sure the scale is set to 100%; do not fit to page. See <a href="help/printingadjustments.xhtml" target="help">instructions for professional printing</a>.</li>
        <li>Cut along all of the red lines.</li>
        <li>Laminate the cards. Keep the plastic rectangular, except for rounded corners; do not cut out the notches on the right hand side. Make sure the plastic is sealed; there must be a few mm between the edge of the paper and the plastic card.</li>
        <li>Have a successful competition!</li>
      </ol>
      <div id="onlineInstructions">
        <ol start="14">
          <li>Unzip the files.</li>
          <li>Upload the files into <a href="http://www.yq.cz/trail-o/TempO/" target="prerequisites" rel="external">TempO Simulator</a>.</li>
        </ol>
      </div>
    </section>
  </main>
</body>
</html>
